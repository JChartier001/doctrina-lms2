<!doctype html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Standards Audit Report - doctrina-lms</title>
		<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
		<style>
			* {
				margin: 0;
				padding: 0;
				box-sizing: border-box;
			}

			body {
				font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
				background: #f5f5f5;
				color: #333;
				line-height: 1.6;
			}

			.container {
				max-width: 1400px;
				margin: 0 auto;
				padding: 20px;
			}

			header {
				background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
				color: white;
				padding: 40px 20px;
				border-radius: 12px;
				margin-bottom: 30px;
				box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
			}

			h1 {
				font-size: 2.5rem;
				margin-bottom: 10px;
			}

			.subtitle {
				font-size: 1.1rem;
				opacity: 0.9;
			}

			.stats-grid {
				display: grid;
				grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
				gap: 20px;
				margin-bottom: 30px;
			}

			.stat-card {
				background: white;
				padding: 25px;
				border-radius: 12px;
				box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
				transition: transform 0.2s;
			}

			.stat-card:hover {
				transform: translateY(-4px);
				box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
			}

			.stat-label {
				font-size: 0.9rem;
				color: #666;
				margin-bottom: 8px;
				text-transform: uppercase;
				letter-spacing: 0.5px;
			}

			.stat-value {
				font-size: 2.5rem;
				font-weight: bold;
				color: #333;
			}

			.stat-value.score {
				color: #f59e0b;
			}

			.chart-container {
				background: white;
				padding: 30px;
				border-radius: 12px;
				box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
				margin-bottom: 30px;
			}

			.chart-title {
				font-size: 1.5rem;
				margin-bottom: 20px;
				color: #333;
			}

			canvas {
				max-height: 400px;
			}

			.violations-table {
				background: white;
				padding: 30px;
				border-radius: 12px;
				box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
				overflow-x: auto;
			}

			table {
				width: 100%;
				border-collapse: collapse;
			}

			thead {
				background: #f9fafb;
			}

			th {
				padding: 12px;
				text-align: left;
				font-weight: 600;
				color: #374151;
				border-bottom: 2px solid #e5e7eb;
			}

			td {
				padding: 12px;
				border-bottom: 1px solid #e5e7eb;
			}

			tbody tr:hover {
				background: #f9fafb;
			}

			.severity-badge {
				display: inline-block;
				padding: 4px 12px;
				border-radius: 20px;
				font-size: 0.85rem;
				font-weight: 600;
			}

			.severity-error {
				background: #fee2e2;
				color: #991b1b;
			}

			.severity-warning {
				background: #fef3c7;
				color: #92400e;
			}

			.severity-info {
				background: #dbeafe;
				color: #1e40af;
			}

			.file-path {
				font-family: 'Monaco', 'Courier New', monospace;
				font-size: 0.9rem;
				color: #6366f1;
			}

			.code-snippet {
				background: #f3f4f6;
				padding: 8px 12px;
				border-radius: 6px;
				font-family: 'Monaco', 'Courier New', monospace;
				font-size: 0.85rem;
				margin: 8px 0;
				border-left: 3px solid #6366f1;
			}

			.fix-suggestion {
				background: #ecfdf5;
				padding: 8px 12px;
				border-radius: 6px;
				font-size: 0.9rem;
				margin-top: 8px;
				border-left: 3px solid #10b981;
				color: #065f46;
			}

			.search-box {
				margin-bottom: 20px;
				padding: 12px;
				border: 2px solid #e5e7eb;
				border-radius: 8px;
				width: 100%;
				font-size: 1rem;
			}

			.search-box:focus {
				outline: none;
				border-color: #6366f1;
			}

			@media (max-width: 768px) {
				h1 {
					font-size: 1.8rem;
				}

				.stats-grid {
					grid-template-columns: 1fr;
				}

				.stat-value {
					font-size: 2rem;
				}
			}
		</style>
	</head>
	<body>
		<div class="container">
			<header>
				<h1>üîç Standards Audit Report</h1>
				<p class="subtitle">doctrina-lms ‚Ä¢ 11/19/2025, 6:48:11 PM</p>
			</header>

			<div class="stats-grid">
				<div class="stat-card">
					<div class="stat-label">Compliance Score</div>
					<div class="stat-value score">87.3%</div>
				</div>
				<div class="stat-card">
					<div class="stat-label">Total Files</div>
					<div class="stat-value">453</div>
				</div>
				<div class="stat-card">
					<div class="stat-label">Total Violations</div>
					<div class="stat-value">142</div>
				</div>
				<div class="stat-card">
					<div class="stat-label">Errors</div>
					<div class="stat-value" style="color: #ef4444">58</div>
				</div>
			</div>

			<div class="chart-container">
				<h2 class="chart-title">Violations by Standard</h2>
				<canvas id="standardsChart"></canvas>
			</div>

			<div class="chart-container">
				<h2 class="chart-title">Violations by Severity</h2>
				<canvas id="severityChart"></canvas>
			</div>

			<div class="violations-table">
				<h2 class="chart-title">All Violations</h2>
				<input
					type="text"
					class="search-box"
					id="searchBox"
					placeholder="Search violations by file, message, or rule..."
				/>
				<table id="violationsTable">
					<thead>
						<tr>
							<th>File</th>
							<th>Line</th>
							<th>Rule</th>
							<th>Severity</th>
							<th>Message</th>
							<th>Details</th>
						</tr>
					</thead>
					<tbody>
						<tr>
							<td class="file-path">app/dashboard/page.tsx</td>
							<td>12</td>
							<td>nextjs-001</td>
							<td>
								<span class="severity-badge severity-error">ERROR</span>
							</td>
							<td>Component uses hooks but missing "use client"</td>
							<td>
								<div class="code-snippet">const [user] = useState()</div>
								<div class="fix-suggestion">üí° Add "use client" directive at top of file</div>
							</td>
						</tr>

						<tr>
							<td class="file-path">components/courses/CourseCard.tsx</td>
							<td>8</td>
							<td>react-003</td>
							<td>
								<span class="severity-badge severity-error">ERROR</span>
							</td>
							<td>Default export instead of named export</td>
							<td>
								<div class="code-snippet">export default function CourseCard() { ... }</div>
								<div class="fix-suggestion">üí° Change to: export function CourseCard() { ... }</div>
							</td>
						</tr>

						<tr>
							<td class="file-path">lib/utils/format.ts</td>
							<td>15</td>
							<td>ts-005</td>
							<td>
								<span class="severity-badge severity-warning">WARNING</span>
							</td>
							<td>Missing explicit return type</td>
							<td>
								<div class="code-snippet">export function formatDate(date) {</div>
								<div class="fix-suggestion">üí° Add return type: export function formatDate(date: Date): string {</div>
							</td>
						</tr>

						<tr>
							<td class="file-path">convex/users.ts</td>
							<td>45</td>
							<td>security-007</td>
							<td>
								<span class="severity-badge severity-error">ERROR</span>
							</td>
							<td>Missing authentication check in mutation</td>
							<td>
								<div class="code-snippet">export const updateUser = mutation({</div>
								<div class="fix-suggestion">
									üí° Add: const identity = await ctx.auth.getUserIdentity(); if (!identity) throw new
									Error("Unauthorized");
								</div>
							</td>
						</tr>

						<tr>
							<td class="file-path">app/courses/[id]/page.tsx</td>
							<td>3</td>
							<td>nextjs-002</td>
							<td>
								<span class="severity-badge severity-warning">WARNING</span>
							</td>
							<td>Client component could be server component</td>
							<td>
								<div class="code-snippet">&quot;use client&quot;;</div>
								<div class="fix-suggestion">üí° Remove "use client" and fetch data server-side</div>
							</td>
						</tr>

						<tr>
							<td class="file-path">components/ui/Button.test.tsx</td>
							<td>12</td>
							<td>testing-001</td>
							<td>
								<span class="severity-badge severity-error">ERROR</span>
							</td>
							<td>Test committed with .only() flag</td>
							<td>
								<div class="code-snippet">it.only(&#039;renders button&#039;, () =&gt; {</div>
								<div class="fix-suggestion">üí° Remove .only(): it('renders button', () => {</div>
							</td>
						</tr>

						<tr>
							<td class="file-path">components/forms/LoginForm.tsx</td>
							<td>28</td>
							<td>react-012</td>
							<td>
								<span class="severity-badge severity-warning">WARNING</span>
							</td>
							<td>Inline object literal in JSX prop</td>
							<td>
								<div class="code-snippet">&lt;Component style={{ margin: 10 }} /&gt;</div>
								<div class="fix-suggestion">üí° Extract to constant outside render</div>
							</td>
						</tr>

						<tr>
							<td class="file-path">app/layout.tsx</td>
							<td>18</td>
							<td>tailwind-003</td>
							<td>
								<span class="severity-badge severity-info">INFO</span>
							</td>
							<td>Hardcoded color instead of theme variable</td>
							<td>
								<div class="code-snippet">className=&quot;bg-blue-500&quot;</div>
								<div class="fix-suggestion">üí° Use theme: className="bg-primary"</div>
							</td>
						</tr>
					</tbody>
				</table>
			</div>
		</div>

		<script>
			// Standards Chart
			const standardsData = { typescript: 45, react: 32, nextjs: 28, security: 15, testing: 12, forms: 7, tailwind: 3 };
			const standardsCtx = document.getElementById('standardsChart').getContext('2d');
			new Chart(standardsCtx, {
				type: 'bar',
				data: {
					labels: Object.keys(standardsData).map(s => s.charAt(0).toUpperCase() + s.slice(1)),
					datasets: [
						{
							label: 'Violations',
							data: Object.values(standardsData),
							backgroundColor: ['#6366f1', '#8b5cf6', '#ec4899', '#ef4444', '#f59e0b', '#10b981', '#06b6d4'],
						},
					],
				},
				options: {
					responsive: true,
					maintainAspectRatio: true,
					plugins: {
						legend: {
							display: false,
						},
					},
					scales: {
						y: {
							beginAtZero: true,
							ticks: {
								precision: 0,
							},
						},
					},
				},
			});

			// Severity Chart
			const severityData = { error: 58, warning: 72, info: 12 };
			const severityCtx = document.getElementById('severityChart').getContext('2d');
			new Chart(severityCtx, {
				type: 'doughnut',
				data: {
					labels: ['Error', 'Warning', 'Info'],
					datasets: [
						{
							data: [severityData.error, severityData.warning, severityData.info],
							backgroundColor: ['#ef4444', '#f59e0b', '#3b82f6'],
						},
					],
				},
				options: {
					responsive: true,
					maintainAspectRatio: true,
				},
			});

			// Search functionality
			const searchBox = document.getElementById('searchBox');
			const table = document.getElementById('violationsTable');
			const rows = table.getElementsByTagName('tbody')[0].getElementsByTagName('tr');

			searchBox.addEventListener('input', function () {
				const searchTerm = this.value.toLowerCase();

				for (let i = 0; i < rows.length; i++) {
					const row = rows[i];
					const text = row.textContent.toLowerCase();

					if (text.includes(searchTerm)) {
						row.style.display = '';
					} else {
						row.style.display = 'none';
					}
				}
			});
		</script>
	</body>
</html>
